id: https://hotecosystem.org/tccm/entityreference
name: entityreference
title: EntityReference model
license: https://creativecommons.org/publicdomain/zero/1.0/
description: |-
  TCCM differentiates between a simple resource reference, such as a code system, code system version, value set, etc.
  and a reference to an Entity - a class, predicate, or individual. Simple resource references are identified by a
  single URI. Entity references, however, are subdivided into two parts - a scoping namespace and an identifier that is
  unique within the context of the namespace.

  This model defines three building blocks that are used for referencing entities throughout the specification.
  The first form, URIAndEntityName provides the URI and local name by which the entity is known within the context of
  the service. An optional href may also be supplied that resolves to the EntityDescription that is contextually
  appropriate.

  The second form, EntityReference, supplies the uri and name but also includes a list of code system versions that
  make one or more assertions about (or using) the referenced entity. There will be at most one version of any given
  code system in this list, the choice of which will depend on the context of the query.
  The third form, EntityExpression, is a description of an Entity in an external language and syntax such as RDF/ OWL,
  Manchester OWL, or SNOMED CT Compositional Grammar.



comments:
  - Derived from Section 2.2.3 Entity References in CTS2 Core specification
  - |-
    This specification differs from the CTS2 equivalent in th following ways:
    1) AnonymousEntityReference, a feature that was added to CTS2 to support an OWL edge case, is not supported in TCCM
    2) DescriptionInCodeSystem is not explicated in the TCCM.  The `see_also` entity has been added instead that can
       supply a link in an arbitrary format
    3) EntityReference and URIAndEntityName have been collapsed together and the namespace identifier and its URI have
       been moved to the List container

prefixes:
  tccm: https://hotecosystem.org/tccm/

# NOTE: Remove this once we get the prefix issues resolved
emit_prefixes:
  - rdf
  - skos

default_prefix: tccm
default_range: string

imports:
  - ../core/datatypes
  - ../core/uritypes
  - ../core/localidentifiers
  - ../core/references


classes:
  EntityReferenceList:
    description: A collection (set) of zero or more entity references that belong to the same scoping namespace
    notes:
      - We need to determine whether the URI or the name is canonical
    attributes:
      namespaceURI:
        description: The URI associated with the supplied namespace as determined by the author/service instance
        range: ExternalURI
        key: true
      namespaceName:
        description: The local identifier assigned to this namespace
        range: CodeSystemName
      entities:
        description: The entity references ("concept codes") in the list
        range: EntityReference
        multivalued: true
        inlined: true

  EntityReference:
    description: The URI, namespace/name (if known) and a list of code systems that make assertions about the entity.
    attributes:
      about:
        description: The external, permanant URI by which this entity is known.
        range: PersistentURI
        readonly: This is generated by the TCCM service instance using the containing EntityReferenceList
      code:
        description: The namespace and name by which this entity is known within the context of the service implementation
        range: string
        required: true
        key: true
        slot_uri: rdf:id
      designation:
        description: The preferred label for the entity in the context of the service
        range: string
        slot_uri: skos:prefLabel
        readonly: This is supplied by the TCCM service
      description:
        description: A description or definition of the referenced entity determined by the service
        range: string
        slot_uri: skos:definition
        readonly: This is supplied by the TCCM service
      href:
        description: A reference to the "official" description of the entity in the context of the defining code system
        range: RenderingURI
        readonly: This is supplied by the TCCM service
      see_also:
        description: Additional external links that serve to define or otherwise clarify the intent of the reference
        range: RenderingURI
        multivalued: true


  EntityExpression:
    description: |-
      An expression in a given ontology language and syntax that describes or defines an entity. Examples might include
      descriptions of entities in Manchester OWL Syntax, RDF, SNOMED Concept Expression, etc.
    notes:
      - |-
        The CTS2 specification had an OntologyLanguageAndSyntaxReference.  We believe that the syntax portion fits in
        OpaqueData
    attributes:
      ontologyLanguage:
        description: The ontology language of the expression.
        range: OntologyLanguageReference
        required: true
        inlined: true
      expression:
        description: The actual Expression.
        range: OpaqueData
        required: true
        inlined: true
